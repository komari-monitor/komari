import{j as s,R as L,r as N,u as D}from"./entry-index-B_BwMGDA.js";import{u as E}from"./chunk-NodeDetailsContext-zCokq4cf.js";import{T as H,a as P,c as T,d as _,b as y,e as g}from"./chunk-table-C7OLDXxB.js";import{S as z}from"./chunk-search-BdPb8rle.js";import{u as B,c as F}from"./chunk-text-field-DU038-QT.js";import{c as k}from"./chunk-checkbox-DQkPJIPQ.js";function M(m){const{className:p="",hiddenDescription:b=!1,value:C,onChange:t,items:c,getId:u,getLabel:o,sortItems:i,filterItem:n,searchPlaceholder:a="Search…",headerLabel:d="Items"}=m,l=C??[],[f,R]=L.useState(""),v=L.useMemo(()=>{let e=[...c];if(i&&e.sort(i),f.trim()){const r=f.toLowerCase();e=e.filter(h=>n?n(h,f):String(o(h)).toLowerCase().includes(r))}return e},[c,i,n,f,o]),x=v.map(u),I=x.length>0&&x.every(e=>l.includes(e)),w=l.length>0&&l.some(e=>x.includes(e))&&!I,A=l.filter(e=>!c.some(r=>u(r)===e)),S=N.useRef(null);N.useEffect(()=>{S.current&&(S.current.indeterminate=w)},[w]);const $=e=>{t(e?Array.from(new Set([...l,...x])):l.filter(r=>!x.includes(r)))},j=(e,r)=>{t(r?Array.from(new Set([...l,e])):l.filter(h=>h!==e))};return s.jsxs("div",{className:`flex flex-col ${p}`,children:[s.jsx(B,{className:"mb-2 flex items-center gap-1",placeholder:a,value:f,onChange:e=>R(e.target.value),children:s.jsx(F,{children:s.jsx(z,{size:"16"})})}),s.jsx("div",{className:"selector rounded-md overflow-hidden",children:s.jsxs(H,{children:[s.jsxs(P,{children:[s.jsx(T,{children:s.jsx(k,{ref:S,checked:I,onCheckedChange:e=>$(!!e),"aria-label":"Select all"})}),s.jsx(T,{children:d})]}),s.jsxs(_,{children:[v.map(e=>{const r=u(e);return s.jsxs(y,{onClick:()=>{j(r,!l.includes(r))},children:[s.jsx(g,{children:s.jsx(k,{checked:l.includes(r),onCheckedChange:h=>j(r,!!h),"aria-label":`Select ${r}`})}),s.jsx(g,{children:o(e)})]},r)}),A.map(e=>s.jsxs(y,{onClick:()=>{j(e,!l.includes(e))},children:[s.jsx(g,{children:s.jsx(k,{checked:l.includes(e),onCheckedChange:r=>j(e,!!r),"aria-label":`Select ${e}`})}),s.jsx(g,{children:e})]},e))]})]})}),!b&&s.jsxs("label",{className:"text-sm text-gray-500",children:["已选择 ",l.length]})]})}function V(m){return s.jsx(M,{...m})}const U=({className:m="",hiddenDescription:p=!1,value:b,onChange:C,hiddenUuidOnlyClient:t=!1})=>{const{nodeDetail:c,isLoading:u,error:o}=E(),{t:i}=D();let n=b;return t&&(n=n.filter(a=>c.find(d=>d.uuid===a&&!d.is_only_client))),u?s.jsx("div",{children:"Loading..."}):o?s.jsx("div",{children:o}):s.jsx(V,{className:m,hiddenDescription:p,value:n,onChange:C,items:[...c],sortItems:(a,d)=>(a.weight??0)-(d.weight??0),getId:a=>a.uuid,getLabel:a=>a.name,searchPlaceholder:i("common.search"),headerLabel:i("common.server")})};export{U as N,V as S};
