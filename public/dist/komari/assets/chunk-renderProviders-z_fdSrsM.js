import{j as l,t as c}from"./entry-index-B_BwMGDA.js";import{a as N,g as w,b as y,S as V,e as I,c as _}from"./chunk-SettingCard-tB6Omhiy.js";const F=({currentProvider:m,providerDefs:h,providerValues:g,translationPrefix:u,title:S,description:b,footer:v,setProviderValues:x,handleSave:$,t:a})=>{if(!m||!h[m])return null;const p=h[m],j=async()=>{try{const e={...g},i=p.filter(n=>n.required).filter(n=>{const t=e[n.name];return t==null||typeof t=="string"&&t.trim()===""});if(i.length>0){const n=i.map(t=>a(`${u}.${t.name}`,t.name)).join(", ");c.error(a("settings.missing_required_fields",{fieldNames:n}));return}const r={...e};p.forEach(n=>{const t=r[n.name];if(t!=null){if(["int","int64"].includes(n.type)){const s=t===""?0:Number(t);if(isNaN(s))throw c.error(a("settings.invalid_number",{field:a(`${u}.${n.name}`,n.name)})),new Error(`Invalid integer value for ${n.name}`);if(!Number.isInteger(s))throw c.error(a("settings.invalid_integer",{field:a(`${u}.${n.name}`,n.name)})),new Error(`Value must be an integer for ${n.name}`);r[n.name]=s}else if(["float32","float64"].includes(n.type)){const s=t===""?0:Number(t);if(isNaN(s))throw c.error(a("settings.invalid_number",{field:a(`${u}.${n.name}`,n.name)})),new Error(`Invalid float value for ${n.name}`);r[n.name]=s}}}),await $(r)}catch(e){throw console.error("Validation error:",e),e}},d=(e,o)=>{x(i=>({...i,[e]:o}))},C=e=>{const o=String(a(`${u}.${e.name}`,e.name))+(e.required?" *":""),i=e.help?String(a(`${u}.${e.name}_help`,e.help)):void 0,r=g[e.name]!==void 0?g[e.name]:e.default||"";if(e.type==="option"&&e.options)return l.jsx(y,{bordless:!0,title:o,description:i,options:e.options.split(",").map(t=>({value:t,label:t})),defaultValue:r,OnSave:t=>{d(e.name,t)}},e.name);if(e.type==="bool")return l.jsx(V,{bordless:!0,title:o,description:i,defaultChecked:r!==void 0?!!r:e.default==="true"||e.default===!0,onChange:t=>{d(e.name,t)}},e.name);if(e.type==="richtext"||e.type==="text")return l.jsx(I,{bordless:!0,title:o,description:i,defaultValue:String(r),showSaveButton:!1,onChange:t=>{d(e.name,t.target.value)},OnSave:t=>{d(e.name,t)}},e.name);const n=["int","int64","float32","float64"].includes(e.type);return l.jsx(_,{bordless:!0,title:o,description:i,defaultValue:String(r),type:n?"number":"text",showSaveButton:!1,onChange:t=>{const s=n?t.target.value===""?0:Number(t.target.value):t.target.value;d(e.name,s)},OnSave:()=>{}},e.name)};return l.jsx("div",{children:l.jsx(N,{title:S??"详情",description:b,defaultOpen:!0,children:l.jsxs("div",{className:"flex gap-4 flex-col",children:[p.map(e=>C(e)),v&&l.jsx("label",{className:"text-sm text-muted-foreground mt-2 block",children:v}),l.jsx(w,{bordless:!0,onClick:j,children:a("save","保存")})]})})},m)};export{F as r};
